<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core"
		xmlns:http="http://www.mulesoft.org/schema/mule/http"
		xmlns="http://www.mulesoft.org/schema/mule/core"
		xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
		xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
		xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd">

	<import doc:name="Import"
			doc:id="72ec1ad3-6910-4038-848e-8af9dbb838bf" file="test-tracer.xml" />

	<http:listener-config name="HTTP_Listener_config"
						  doc:name="HTTP Listener config"
						  doc:id="dcd1ab6b-03d7-41d8-a0d2-5cb9a70a9eba" basePath="/">
		<http:listener-connection host="0.0.0.0"
								  port="${http.port}" />
	</http:listener-config>
	<http:request-config name="HTTP_Request_configuration" doc:name="HTTP Request configuration" doc:id="c18eed36-eb42-4c29-abc9-9e7a2c6049e1" >
		<http:request-connection host="0.0.0.0" port="${http.port}" />
	</http:request-config>
	<flow name="SimpleFlowTestFlow"
		  doc:id="f42f8120-fb86-4213-8808-4c1e3795816c">
		<http:listener doc:name="Listener"
					   doc:id="fee82c53-3e44-4163-b71d-0a26891562d7"
					   config-ref="HTTP_Listener_config" path="/test/{userId}" />
		<logger level="INFO" doc:name="Logger"
				doc:id="d7c9aa3a-63ec-407f-ab77-e71d3cd67519" message="start" />
		<flow-ref doc:name="Flow Reference" doc:id="f6d0cfde-d136-4406-9001-3a841a338bde" name="SimpleFlowTestSub_Flow"/>
		<http:request method="GET" doc:name="Request" doc:id="e7efe88f-6969-4297-8cd0-88ab52269691" config-ref="HTTP_Request_configuration" path="/remote/test"/>
		<logger level="INFO" doc:name="Logger"
				doc:id="1ac4fcf6-13ad-41d4-a30e-c064c93c93f4" message="end local" />
	</flow>
	<flow name="RemoteHttpTestFlow"
		  doc:id="db58c112-c608-4d72-977f-d97c3f71e440">
		<http:listener doc:name="Listener"
					   doc:id="2de7be5b-821d-4853-9900-940f2677e06b"
					   config-ref="HTTP_Listener_config" path="/remote/test" />
		<logger level="INFO" doc:name="Logger"
				doc:id="9f5c9898-7daa-4771-b279-ec7298847f93" message="end Remote" />
		<set-payload value="Done"/>
	</flow>
	<sub-flow name="SimpleFlowTestSub_Flow" doc:id="487f5841-41ee-4570-bc38-49b22ea92337" >
		<logger level="INFO" doc:name="Logger" doc:id="6a031d69-7f77-4317-991b-6d66e2f0cdc1" />
	</sub-flow>
	<flow name="Server400TestFlow"
		  doc:id="f42f8120-fb86-4213-8808-4c1e3795816c">
		<http:listener doc:name="Listener"
					   doc:id="fee82c53-3e44-4163-b71d-0a26891562d7"
					   config-ref="HTTP_Listener_config" path="/test/error/400">
			<http:response statusCode="400" />
		</http:listener>
		<logger level="INFO" doc:name="Logger"
				doc:id="d7c9aa3a-63ec-407f-ab77-e71d3cd67519" message="start" />
	</flow>
	<flow name="ExceptionFlowTestFlow"
		  doc:id="f42f8120-fb86-4213-8808-4c1e3795816c">
		<http:listener doc:name="Listener"
					   doc:id="fee82c53-3e44-4163-b71d-0a26891562d7"
					   config-ref="HTTP_Listener_config" path="/test/exception">
			<http:error-response >
				<http:body ><![CDATA[Failed]]></http:body>
			</http:error-response>
		</http:listener>
		<logger level="INFO" doc:name="Logger"
				doc:id="d7c9aa3a-63ec-407f-ab77-e71d3cd67519" message="start" />
		<flow-ref doc:name="Flow Reference" doc:id="f6d0cfde-d136-4406-9001-3a841a338bde" name="SimpleFlowTestSub_Flow"/>
		<http:request method="GET" doc:name="Request" doc:id="e7efe88f-6969-4297-8cd0-88ab52269691" config-ref="HTTP_Request_configuration" path="/remote/test2"/>
		<logger level="INFO" doc:name="Logger"
				doc:id="1ac4fcf6-13ad-41d4-a30e-c064c93c93f4" message="end local" />
	</flow>
</mule>

